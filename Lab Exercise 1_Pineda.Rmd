---
title: "Lab Exercise 1_Pineda"
output: pdf_document
date: "2024-02-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Scraping for Handbags

```{r}

library(tidyverse)
library(dplyr)
library(rvest)
library(httr)
library(polite)
library(ggplot2)

Handbag_Products <- data.frame()

HandbagLink1 = "https://www.amazon.co.uk/s?k=handbags&crid=TXLH0DAZWXCO&qid=1708264736&sprefix=handbags%2Caps%2C399&ref=sr_pg_1"

session1 <- bow(HandbagLink1, user_agent = "Educational Purposes")

ScrapeNodes <- function(selector){
scrape(session1) %>%
  html_nodes(selector) %>%
  html_text(trim = TRUE)
}

ScrapedCategory <- "Handbags"

ScrapedName <- ScrapeNodes("div.a-section.a-spacing-small puis-padding-left-small.puis-padding-right-small")
ScrapedName <- ScrapedName[1:45]

ScrapedPrice <- ScrapeNodes("span.a-price")
ScrapedPrice <- ScrapedPrice[1:45]

ScrapedRatings <- ScrapeNodes("i.a-icon a-icon-popover")
ScrapedRatings <- ScrapedRatings[1:45]

ScrapedReviews <- ScrapeNodes("i.a-icon.a-icon-star-small a-star-small-4.aok-align-bottom")
ScrapedReviews <- ScrapedReviews[1:45]

Handbags_Products <- rbind(Handbag_Products, data.frame(category = ScrapedCategory,name = ScrapedName,
                    price = ScrapedPrice, ratings = ScrapedRatings,Num_of_reviews = ScrapedReviews))

##############

HandbagLink2 = "https://www.amazon.co.uk/s?k=handbags&page=2&crid=TXLH0DAZWXCO&qid=1708264709&sprefix=handbags%2Caps%2C399&ref=sr_pg_1"

Session2 <- bow(HandbagLink2, user_agent = "Educational Purposes")

ScrapedCategory <- "Handbags" 

ScrapedName2 <- ScrapeNodes("div.a-section.a-spacing-small puis-padding-left-small.puis-padding-right-small")
ScrapedName2 <- ScrapedName2[1:45]

ScrapedPrice2 <- ScrapeNodes("div.a-row")
ScrapedPrice2 <- ScrapedPrice2[1:45]

ScrapedRatings2 <- ScrapeNodes("span.a-size-base.s-underline-text")
ScrapedRatings2 <- ScrapedRatings2[1:45]

ScrapedReviews2 <- ScrapeNodes("span.a-size-base.s-underline-text")
ScrapedReviews2 <- ScrapedReviews2[1:45]

Handbags_Products <- rbind(Handbag_Products, data.frame(category = ScrapedCategory,name = ScrapedName,
                    price = ScrapedPrice, ratings = ScrapedRatings,Num_of_reviews = ScrapedReviews))
```

